Absolutely! Here's an updated **multithreaded port scanner** that first resolves a domain name to an IP address before scanning:

```python
import socket
import threading
from queue import Queue

# Thread-safe queue for ports
port_queue = Queue()
open_ports = []
lock = threading.Lock()

def scan_port(ip):
    while not port_queue.empty():
        port = port_queue.get()
        try:
            s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
            s.settimeout(0.5)
            result = s.connect_ex((ip, port))
            if result == 0:
                with lock:
                    print(f"[OPEN] Port {port}")
                    open_ports.append(port)
            s.close()
        except socket.error:
            pass
        finally:
            port_queue.task_done()

def main():
    host = input("Enter target host (IP or domain): ")
    
    # Resolve domain to IP
    try:
        ip = socket.gethostbyname(host)
        print(f"Resolved {host} to {ip}\n")
    except socket.gaierror:
        print(f"Unable to resolve host: {host}")
        return

    start_port = int(input("Enter start port: "))
    end_port = int(input("Enter end port: "))
    num_threads = int(input("Enter number of threads: "))

    # Fill the queue with ports
    for port in range(start_port, end_port + 1):
        port_queue.put(port)

    print(f"Scanning ports {start_port}-{end_port} on {ip} using {num_threads} threads...\n")

    # Start threads
    threads = []
    for _ in range(num_threads):
        t = threading.Thread(target=scan_port, args=(ip,))
        t.start()
        threads.append(t)

    # Wait for all threads to finish
    port_queue.join()

    print("\nScan completed.")
    if open_ports:
        print(f"Open ports on {ip}: {sorted(open_ports)}")
    else:
        print(f"No open ports found on {ip} in the range {start_port}-{end_port}.")

if __name__ == "__main__":
    main()
```

---

### **Features**

* Resolves domain names to IP addresses using `socket.gethostbyname()`.
* Multithreaded for fast scanning.
* Real-time reporting of open ports and final sorted list.
* Handles invalid domain names gracefully.

---

If you want, I can create a **fully-featured scanner** that:

* Resolves multiple domains from a file.
* Scans multiple port ranges.
* Uses multithreading efficiently for both hosts and ports.

Do you want me to make that version?
