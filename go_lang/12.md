Below is a **clear, complete, production-ready guide** showing how to implement **structured logging in Go** using **Zap** (Uber) and **Logrus** (Sirupsen).

You‚Äôll learn:

‚úÖ Setup
‚úÖ Basic usage
‚úÖ Fields (structured logs)
‚úÖ Log levels
‚úÖ JSON logging
‚úÖ Middleware usage (HTTP)
‚úÖ Best practices

---

# üöÄ **1. Structured Logging With Zap**

Zap is one of the **fastest** structured loggers in Go.

---

## ‚úÖ **Installation**

```bash
go get go.uber.org/zap
```

---

# ‚≠ê **Example 1: Using Zap (Sugared Logger)**

Good for developer-friendly logs.

```go
package main

import (
    "go.uber.org/zap"
)

func main() {
    logger, _ := zap.NewProduction()
    defer logger.Sync()

    sugar := logger.Sugar()

    sugar.Infow("User logged in",
        "user_id", 42,
        "ip", "192.168.1.1",
    )
    sugar.Warnw("Low balance",
        "account", "ACC123",
        "balance", 50.25,
        "currency", "INR",
    )
}
```

### Output (JSON structured):

```json
{
  "level":"info",
  "msg":"User logged in",
  "user_id":42,
  "ip":"192.168.1.1",
  "time":"2025-01-01T12:30:00Z"
}
```

---

# ‚≠ê **Example 2: Using Zap (Strict Structured Logger)**

Use this when performance matters.

```go
logger, _ := zap.NewProduction()

logger.Info("Payment processed",
    zap.String("user", "sandeep"),
    zap.Float64("amount", 799.50),
    zap.Bool("success", true),
)
```

---

# ‚≠ê **Example 3: Custom Zap Configuration**

```go
config := zap.Config{
    Encoding:         "json",
    Level:            zap.NewAtomicLevelAt(zap.InfoLevel),
    OutputPaths:      []string{"stdout", "logs/app.log"},
    ErrorOutputPaths: []string{"stderr"},
    EncoderConfig: zap.NewProductionEncoderConfig(),
}

logger, _ := config.Build()
logger.Info("custom config log", zap.String("env", "production"))
```

---

# üåê **Example 4: Zap with Gin/Fiber HTTP Middleware**

### Zap Middleware Sample:

```go
func LoggingMiddleware(logger *zap.Logger) func(http.Handler) http.Handler {
    return func(next http.Handler) http.Handler {
        return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {

            logger.Info("Incoming request",
                zap.String("method", r.Method),
                zap.String("path", r.URL.Path),
                zap.String("ip", r.RemoteAddr),
            )

            next.ServeHTTP(w, r)
        })
    }
}
```

---

# ‚≠ê **Zap Best Practices**

‚úî Use `zap.NewProduction()` in production
‚úî Use structured fields (`zap.String()`, `zap.Bool()`)
‚úî Always call `defer logger.Sync()`
‚úî Avoid `fmt.Println` inside production services

---

---

# üî• 2. Structured Logging With Logrus

Logrus is widely used and simple, but slower than Zap.

---

## ‚úÖ Installation

```bash
go get github.com/sirupsen/logrus
```

---

## ‚≠ê Example 1: Basic Structured Log

```go
package main

import log "github.com/sirupsen/logrus"

func main() {
    log.SetFormatter(&log.JSONFormatter{})

    log.WithFields(log.Fields{
        "user": "sandeep",
        "role": "admin",
        "ip":   "127.0.0.1",
    }).Info("User logged in")
}
```

---

## ‚≠ê Example 2: Log Levels

```go
log.SetLevel(log.WarnLevel)

log.Info("This will NOT appear")
log.Warn("This will appear")
log.Error("This is an error")
```

---

## ‚≠ê Example 3: Custom Logger Instance

```go
logger := log.New()

logger.SetFormatter(&log.JSONFormatter{})
logger.SetOutput(os.Stdout)
logger.SetLevel(log.DebugLevel)

logger.WithFields(log.Fields{
    "order_id": 999,
    "amount":   230.50,
}).Info("Order processed")
```

---

## ‚≠ê Example 4: Logrus Hook (advanced)

Add hooks like file output, Sentry, Kafka, etc.

```go
type AuthHook struct{}

func (h *AuthHook) Levels() []log.Level {
    return log.AllLevels
}

func (h *AuthHook) Fire(entry *log.Entry) error {
    entry.Data["service"] = "auth-service"
    return nil
}

func main() {
    log.AddHook(&AuthHook{})
    log.Warn("Unauthorized access")
}
```

---

# ‚≠ê **Logrus HTTP Middleware Example**

```go
func LoggingMiddleware(next http.Handler) http.Handler {
    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {

        log.WithFields(log.Fields{
            "method": r.Method,
            "path":   r.URL.Path,
            "ip":     r.RemoteAddr,
        }).Info("Incoming Request")

        next.ServeHTTP(w, r)
    })
}
```

---

# ‚öîÔ∏è **Zap vs Logrus ‚Äî Which Should You Use?**

| Feature           | Zap         | Logrus       |
| ----------------- | ----------- | ------------ |
| Speed             | ‚ö° Very Fast | ‚ùå Slower     |
| Flexibility       | High        | Medium       |
| Beginner Friendly | Medium      | Easy         |
| Production Use    | ‚≠ê Best      | Good         |
| Extensibility     | Medium      | High (Hooks) |

‚úî For serious backend projects ‚Üí **Use Zap**
‚úî For quick prototyping or CLIs ‚Üí **Use Logrus**

---
