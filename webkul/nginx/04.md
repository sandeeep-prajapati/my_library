# 1ï¸âƒ£ What Weâ€™re Setting Up

âœ” Free SSL using **Letâ€™s Encrypt**
âœ” **Auto-renewal** (no manual work later)
âœ” **HTTP â†’ HTTPS redirect**
âœ” **Strong TLS security headers**

---

# 2ï¸âƒ£ Prerequisites

Before starting, make sure:

* âœ… Domain points to your server IP
* âœ… Nginx installed and running
* âœ… Port **80 & 443 open**

Check:

```bash
nginx -v
```

---

# 3ï¸âƒ£ Install Certbot (Letâ€™s Encrypt Client)

### Ubuntu / Debian

```bash
sudo apt update
sudo apt install certbot python3-certbot-nginx -y
```

### Verify

```bash
certbot --version
```

---

# 4ï¸âƒ£ Basic Nginx HTTP Config (Before SSL)

```nginx
server {
    listen 80;
    server_name example.com www.example.com;

    location / {
        proxy_pass http://127.0.0.1:3000;
    }
}
```

Test:

```bash
sudo nginx -t
sudo systemctl reload nginx
```

---

# 5ï¸âƒ£ Obtain SSL Certificate (One Command Magic âœ¨)

```bash
sudo certbot --nginx -d example.com -d www.example.com
```

Certbot will:

* Verify domain
* Generate certificates
* Update Nginx config automatically
* Enable HTTPS

Certificates are stored at:

```
/etc/letsencrypt/live/example.com/
```

---

# 6ï¸âƒ£ HTTP â†’ HTTPS Redirect (Explicit & Clean)

Even if Certbot adds it, **do it manually for clarity**.

### HTTP Server

```nginx
server {
    listen 80;
    server_name example.com www.example.com;
    return 301 https://$host$request_uri;
}
```

---

# 7ï¸âƒ£ HTTPS Server Block (Production-Ready)

```nginx
server {
    listen 443 ssl http2;
    server_name example.com www.example.com;

    ssl_certificate /etc/letsencrypt/live/example.com/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/example.com/privkey.pem;

    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_prefer_server_ciphers off;

    location / {
        proxy_pass http://127.0.0.1:3000;

        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto https;
    }
}
```

---

# 8ï¸âƒ£ Enable Auto-Renewal (CRITICAL)

Letâ€™s Encrypt certs expire every **90 days**.

### Test Renewal

```bash
sudo certbot renew --dry-run
```

### Systemd Timer (Already Enabled)

```bash
systemctl list-timers | grep certbot
```

It runs:

* Twice a day
* Renews only when needed
* Zero downtime

âœ” Nothing else required ğŸ‰

---

# 9ï¸âƒ£ Security Best Practices (Must Add ğŸ”)

### Security Headers

```nginx
add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always;
add_header X-Frame-Options DENY;
add_header X-Content-Type-Options nosniff;
add_header X-XSS-Protection "1; mode=block";
add_header Referrer-Policy "strict-origin-when-cross-origin";
```

âš ï¸ **HSTS Warning**
Enable only **after HTTPS is stable** â€” browsers will force HTTPS forever.

---

# ğŸ”Ÿ Disable Weak Stuff (Optional but Recommended)

```nginx
ssl_session_timeout 1d;
ssl_session_cache shared:SSL:10m;
ssl_session_tickets off;
```

---

# 11ï¸âƒ£ Common HTTPS Problems & Fixes

### âŒ Redirect Loop

Cause:

* Missing `X-Forwarded-Proto`

Fix:

```nginx
proxy_set_header X-Forwarded-Proto https;
```

---

### âŒ 502 After HTTPS

Cause:

* Backend using HTTP-only logic

Fix:

* Trust proxy in backend (Django / Laravel)

---

### âŒ Mixed Content Error

Cause:

* HTTP assets inside HTTPS page

Fix:

* Use relative URLs or HTTPS everywhere

---

# 12ï¸âƒ£ Verify HTTPS

### Browser

* ğŸ”’ Lock icon
* Certificate details

### CLI

```bash
curl -I https://example.com
```

Look for:

```
HTTP/2 200
strict-transport-security
```

---

# 13ï¸âƒ£ Best Practices Summary (Production Rules)

âœ” Always redirect HTTP â†’ HTTPS
âœ” Use TLS 1.2+ only
âœ” Enable auto-renewal
âœ” Set security headers
âœ” Let Nginx handle SSL, backend stays HTTP
âœ” Test config before reload

```bash
nginx -t && systemctl reload nginx
```

---

# ğŸ¯ Interview-Ready 20-Second Answer

> â€œI use Certbot with Nginx to enable HTTPS via Letâ€™s Encrypt, configure HTTP to HTTPS redirects, enable TLS 1.2/1.3, add security headers like HSTS, and rely on Certbotâ€™s systemd timer for automatic certificate renewal.â€

