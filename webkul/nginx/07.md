# 1Ô∏è‚É£ Core Security Mindset

Nginx is your **first line of defense**:

* Drop bad traffic early
* Protect backend & database
* Keep CPU & memory stable

---

# 2Ô∏è‚É£ Rate Limiting (Stops DDoS & Brute Force)

### Define Rate Limit Zone

```nginx
http {
    limit_req_zone $binary_remote_addr
        zone=api_limit:10m
        rate=10r/s;
}
```

* `10m` ‚âà 160k IPs
* `10r/s` per IP

---

### Apply Rate Limit

```nginx
server {
    location /api/ {
        limit_req zone=api_limit burst=20 nodelay;
        proxy_pass http://backend;
    }
}
```

### Effect

* Normal users ‚Üí fine
* Attackers ‚Üí throttled or dropped

---

# 3Ô∏è‚É£ Connection Limiting (Anti-DDoS)

```nginx
http {
    limit_conn_zone $binary_remote_addr zone=conn_limit:10m;
}
```

```nginx
server {
    limit_conn conn_limit 20;
}
```

‚úî Prevents connection floods
‚úî Very low overhead

---

# 4Ô∏è‚É£ Protect Login Endpoints (Brute Force)

```nginx
location /login {
    limit_req zone=api_limit burst=5 nodelay;
    proxy_pass http://backend;
}
```

‚úî Stops password spraying
‚úî Backend stays safe

---

# 5Ô∏è‚É£ Block Bad User Agents & Methods

```nginx
if ($request_method !~ ^(GET|POST|HEAD|OPTIONS)$) {
    return 444;
}
```

```nginx
if ($http_user_agent ~* (curl|wget|sqlmap|nikto)) {
    return 444;
}
```

‚ö†Ô∏è Use carefully ‚Äî avoid blocking legit tools

---

# 6Ô∏è‚É£ Prevent Directory Traversal

```nginx
location ~ \.\. {
    deny all;
}
```

Disable auto-index:

```nginx
autoindex off;
```

Safe file serving:

```nginx
location /uploads/ {
    internal;
}
```

---

# 7Ô∏è‚É£ Hide Sensitive Files

```nginx
location ~* \.(env|log|ini|bak|sql|sh|yml)$ {
    deny all;
}
```

```nginx
location ~ /\. {
    deny all;
}
```

‚úî Protect `.env`, `.git`, `.htaccess`

---

# 8Ô∏è‚É£ Security Headers (MUST HAVE)

```nginx
add_header X-Frame-Options "DENY" always;
add_header X-Content-Type-Options "nosniff" always;
add_header X-XSS-Protection "1; mode=block" always;
add_header Referrer-Policy "strict-origin-when-cross-origin" always;
add_header Permissions-Policy "geolocation=(), microphone=(), camera=()" always;
```

---

# 9Ô∏è‚É£ HSTS (HTTPS Only ‚Äì Use Carefully)

```nginx
add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always;
```

‚ö†Ô∏è Enable **only after HTTPS is stable**

---

# üîü Disable Server Info Leakage

```nginx
server_tokens off;
```

Hides:

```
nginx/1.25.x
```

---

# 11Ô∏è‚É£ Buffer Overflow Protection

```nginx
client_body_buffer_size 128k;
client_header_buffer_size 1k;
large_client_header_buffers 4 8k;
client_max_body_size 20M;
```

Stops:

* Large header attacks
* Upload abuse

---

# 12Ô∏è‚É£ Timeouts (Slowloris Protection)

```nginx
client_header_timeout 10s;
client_body_timeout 10s;
send_timeout 10s;
```

‚úî Drops slow malicious connections

---

# 13Ô∏è‚É£ Fail Fast on Bad Requests

```nginx
location / {
    if ($request_uri ~* "(<|%3C|%00|%2e%2e)") {
        return 444;
    }
}
```

---

# 14Ô∏è‚É£ Full Hardened Server Example

```nginx
server {
    listen 443 ssl http2;
    server_name example.com;

    server_tokens off;

    limit_conn conn_limit 20;
    limit_req zone=api_limit burst=20 nodelay;

    add_header X-Frame-Options DENY always;
    add_header X-Content-Type-Options nosniff always;

    location ~ /\. {
        deny all;
    }

    location / {
        proxy_pass http://backend;
    }
}
```

---

# 15Ô∏è‚É£ What Nginx Can & Can‚Äôt Do

‚úî Rate limiting
‚úî Connection limiting
‚úî Header hardening
‚úî Basic filtering

‚ùå Full WAF (use ModSecurity / Cloudflare)

---

# üéØ Interview-Ready Answer (30 sec)

> ‚ÄúI harden Nginx by applying rate and connection limiting to mitigate DDoS and brute-force attacks, disabling directory traversal and sensitive file access, hiding server tokens, adding strict security headers, and tuning timeouts and buffers to drop malicious slow connections.‚Äù

---

# üß† Pro Tips

* Use **Redis-backed rate limiting** for clusters
* Combine Nginx with **Fail2Ban**
* Use **Cloudflare** for Layer-7 DDoS
* Always monitor:

```bash
tail -f /var/log/nginx/error.log
```

---
