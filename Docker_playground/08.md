## ğŸ“ Project Structure

```
go-api/
â”œâ”€â”€ docker-compose.yml
â”œâ”€â”€ Dockerfile
â”œâ”€â”€ go.mod
â”œâ”€â”€ go.sum
â”œâ”€â”€ main.go
â””â”€â”€ .air.toml
```

---

## ğŸ“„ `go.mod`

module go-api

go 1.22

---

## ğŸ“„ `main.go` (Simple REST API)

package main

import (
"net/http"

```
"github.com/gin-gonic/gin"
```

)

func main() {
r := gin.Default()

```
r.GET("/health", func(c *gin.Context) {
	c.JSON(http.StatusOK, gin.H{
		"status": "ok",
	})
})

r.Run(":8080")
```

}

---

## ğŸ“„ `.air.toml` (Hot Reload Config)

root = "."
tmp_dir = "tmp"

[build]
cmd = "go build -o ./tmp/app"
bin = "tmp/app"
full_bin = "tmp/app"
include_ext = ["go"]
exclude_dir = ["tmp", "vendor"]

[log]
time = true

ğŸ‘‰ `air` watches your Go files and **rebuilds + restarts automatically**.

---

## ğŸ“„ `Dockerfile` (Multi-Stage + Dev Ready)

# ---------- Base image ----------

FROM golang:1.22-alpine AS base

WORKDIR /app

RUN apk add --no-cache git
RUN go install github.com/cosmtrek/air@latest

COPY go.mod go.sum ./
RUN go mod download

COPY . .

# ---------- Development stage ----------

FROM base AS dev
CMD ["air"]

# ---------- Production build ----------

FROM base AS builder
RUN go build -o app

FROM alpine:latest AS prod
WORKDIR /app
COPY --from=builder /app/app .
EXPOSE 8080
CMD ["./app"]

---

## ğŸ“„ `docker-compose.yml` (Hot Reload Enabled)

version: "3.9"

services:
api:
build:
context: .
target: dev
container_name: go_api
volumes:
- .:/app
ports:
- "8080:8080"
environment:
- GO_ENV=development

---

## â–¶ï¸ Run the Development Stack

```bash
docker compose up --build
```

Open in browser:

```
http://localhost:8080/health
```

Response:

```json
{ "status": "ok" }
```

Now:

* Edit `main.go`
* Save file
* API reloads automatically ğŸ”¥

---

## ğŸ§  Why This Setup Is **Industry-Grade**

### âœ… Multi-Stage Build

* Dev â†’ fast iteration
* Prod â†’ tiny, secure image
* Same Dockerfile for both

---

### ğŸ” Hot Reload (Air)

* No rebuilds
* No container restarts
* Same DX as Node / Django

---

### ğŸ“¦ Volume Mounting

```yaml
- .:/app
```

* Local code syncs instantly
* Essential for dev speed

---

### ğŸš€ Clean Separation

| Stage     | Purpose           |
| --------- | ----------------- |
| `dev`     | Local development |
| `builder` | Compile binary    |
| `prod`    | Minimal runtime   |

This is **exactly how Go teams work**.

