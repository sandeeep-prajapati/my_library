## ğŸ“ Updated Project Structure

```
php-mysql/
â”œâ”€â”€ docker-compose.yml
â”œâ”€â”€ .env
â”œâ”€â”€ php/
â”‚   â””â”€â”€ index.php
â””â”€â”€ mysql/
    â””â”€â”€ data/
```

---

## ğŸ“„ `.env` (Environment Variables)

MYSQL_ROOT_PASSWORD=root_pass
MYSQL_DATABASE=app_db
MYSQL_USER=app_user
MYSQL_PASSWORD=app_pass
MYSQL_HOST=db

âš ï¸ **Important**

* No quotes
* No spaces around `=`
* File name must be exactly `.env`

---

## ğŸ“„ Refactored `docker-compose.yml`

version: "3.9"

services:
db:
image: mysql:8.0
container_name: mysql_db
restart: always
env_file:
- .env
environment:
MYSQL_ROOT_PASSWORD: ${MYSQL_ROOT_PASSWORD}
MYSQL_DATABASE: ${MYSQL_DATABASE}
MYSQL_USER: ${MYSQL_USER}
MYSQL_PASSWORD: ${MYSQL_PASSWORD}
volumes:
- ./mysql/data:/var/lib/mysql
networks:
- app_net
healthcheck:
test: ["CMD", "mysqladmin", "ping", "-h", "localhost"]
interval: 10s
timeout: 5s
retries: 5

php:
image: php:8.2-apache
container_name: php_app
ports:
- "8080:80"
volumes:
- ./php:/var/www/html
env_file:
- .env
environment:
MYSQL_HOST: ${MYSQL_HOST}
MYSQL_DATABASE: ${MYSQL_DATABASE}
MYSQL_USER: ${MYSQL_USER}
MYSQL_PASSWORD: ${MYSQL_PASSWORD}
depends_on:
db:
condition: service_healthy
networks:
- app_net

networks:
app_net:
driver: bridge

---

## ğŸ” What Changed & Why It Matters

---

## 1ï¸âƒ£ `.env` File = Separation of Concerns

Instead of this âŒ:

```yaml
MYSQL_PASSWORD: app_pass
```

We now do âœ…:

```yaml
MYSQL_PASSWORD: ${MYSQL_PASSWORD}
```

Why this matters:

* Config â‰  Code
* Same compose file works in:

  * Dev
  * Staging
  * Production

Only `.env` changes.

---

## 2ï¸âƒ£ Security (Huge Deal)

In real projects:

* `docker-compose.yml` â†’ committed to Git
* `.env` â†’ **never committed**

You add `.env` to `.gitignore`:

```
.env
```

This prevents:

* Credential leaks
* Database compromise
* â€œOops I pushed secretsâ€ disasters

---

## 3ï¸âƒ£ Easy Environment Switching

You can have:

```
.env.dev
.env.staging
.env.prod
```

Run with:

```bash
docker compose --env-file .env.dev up
```

This is **industry-standard practice**.

---

## 4ï¸âƒ£ Works Across Tech Stacks

This exact pattern is used in:

* Django (`DATABASE_URL`)
* Laravel (`.env`)
* Node.js (`process.env`)
* Golang (`os.Getenv`)
* Kubernetes ConfigMaps & Secrets

Docker Compose is teaching you **cloud-native habits** here.

---

## â–¶ï¸ Run the Refactored Stack

```bash
docker compose up
```

Nothing changes visually, but internally:

* Your system is safer
* Cleaner
* Production-ready

---

## ğŸ§  What Youâ€™ve Officially Mastered

You now understand:

* Environment-driven configuration
* Secure secret handling
* Portable Docker setups
* Dev â†” Prod parity

This is **senior backend engineering knowledge**.

---
