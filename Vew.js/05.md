### **Handling Form Submissions in Vue.js with Laravel CSRF Protection**

When submitting forms from Vue.js to Laravel, you need to:
1. Include Laravel's CSRF token
2. Handle form data properly
3. Manage validation errors

Here's the **best way** to do it:

---

## **Method 1: Using Axios (Recommended)**
### **1. Set Up Axios Globally (resources/js/app.js)**
```js
import axios from 'axios';
window.axios = axios;

// Set CSRF token for all requests
window.axios.defaults.headers.common['X-Requested-With'] = 'XMLHttpRequest';
window.axios.defaults.withCredentials = true;

// Get CSRF token from meta tag (included by default in Laravel)
const token = document.head.querySelector('meta[name="csrf-token"]');
if (token) {
    window.axios.defaults.headers.common['X-CSRF-TOKEN'] = token.content;
}
```

### **2. Create a Vue Form Component**
```vue
<template>
  <form @submit.prevent="submitForm">
    <input v-model="form.name" type="text" placeholder="Name">
    <input v-model="form.email" type="email" placeholder="Email">
    <button type="submit">Submit</button>
  </form>
  <div v-if="errors">
    <p v-for="error in errors" :key="error" class="text-red-500">{{ error }}</p>
  </div>
</template>

<script setup>
import { reactive, ref } from 'vue';

const form = reactive({
  name: '',
  email: '',
});

const errors = ref({});

const submitForm = async () => {
  try {
    const response = await axios.post('/api/submit-form', form);
    console.log(response.data);
    // Reset form on success
    form.name = '';
    form.email = '';
    errors.value = {};
  } catch (error) {
    if (error.response.status === 422) {
      errors.value = error.response.data.errors;
    }
  }
};
</script>
```

---

## **Method 2: Using Laravel's Built-in CSRF (For Blade + Vue Hybrid)**
### **1. Include CSRF Token in Blade**
```html
<form @submit.prevent="submitForm">
  @csrf <!-- Laravel adds hidden CSRF field -->
  <input v-model="form.name" type="text">
  <button type="submit">Submit</button>
</form>
```

### **2. Submit Using `FormData` (for file uploads)**
```js
const submitForm = async () => {
  const formData = new FormData();
  formData.append('name', form.name);
  formData.append('avatar', fileInput.files[0]);

  const response = await axios.post('/upload', formData, {
    headers: { 'Content-Type': 'multipart/form-data' }
  });
};
```

---

## **Method 3: Using Laravel Sanctum (For SPAs)**
If your Vue app is on a different domain:

### **1. Install Sanctum**
```bash
composer require laravel/sanctum
php artisan vendor:publish --provider="Laravel\Sanctum\SanctumServiceProvider"
```

### **2. Configure CORS (config/cors.php)**
```php
'paths' => ['api/*', 'sanctum/csrf-cookie'],
'allowed_methods' => ['*'],
'allowed_origins' => ['http://your-vue-app.com'],
```

### **3. Fetch CSRF Cookie First**
```js
await axios.get('/sanctum/csrf-cookie');
await axios.post('/api/submit', form);
```

---

## **Best Practices**
1. **Always use `@csrf` in Blade forms** (if mixing Blade + Vue)
2. **For pure Vue apps**, attach CSRF token via Axios defaults
3. **Handle 422 validation errors** gracefully
4. **For file uploads**, use `FormData`
5. **For SPAs**, use Sanctum for CSRF + API auth

---

## **Complete Laravel Backend Example**
```php
// routes/api.php
Route::post('/submit-form', function (Request $request) {
  $validated = $request->validate([
    'name' => 'required|string|max:255',
    'email' => 'required|email',
  ]);

  // Process data...
  return response()->json(['success' => true]);
});
```

---