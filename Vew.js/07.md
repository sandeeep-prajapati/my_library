### **Pinia: Modern State Management for Laravel + Vue Apps**

Pinia is Vue's **official state management library** (replacing Vuex in Vue 3). It offers:
- Simpler syntax than Vuex  
- Full TypeScript support  
- DevTools integration  
- Modular by design  

Perfect for managing **global state** (user auth, API data, UI state) in Laravel+Vue apps.

---

## **1. Install Pinia**
```bash
npm install pinia
```

---

## **2. Set Up Pinia in Laravel**
### **2.1. Initialize Pinia (`resources/js/app.js`)**
```js
import { createApp } from 'vue';
import { createPinia } from 'pinia';
import App from './App.vue';

const app = createApp(App);
app.use(createPinia());
app.mount('#app');
```

---

## **3. Create Your First Store**
### **Example: Auth Store (`resources/js/stores/auth.js`)**
```js
import { defineStore } from 'pinia';
import axios from 'axios';

export const useAuthStore = defineStore('auth', {
  state: () => ({
    user: null,
    token: localStorage.getItem('token') || null,
  }),

  actions: {
    async login(credentials) {
      const response = await axios.post('/api/login', credentials);
      this.user = response.data.user;
      this.token = response.data.token;
      localStorage.setItem('token', response.data.token);
    },

    logout() {
      this.user = null;
      this.token = null;
      localStorage.removeItem('token');
    }
  },

  getters: {
    isAuthenticated: (state) => !!state.token,
  },
});
```

---

## **4. Use the Store in Components**
### **Login Component Example (`resources/js/components/Login.vue`)**
```vue
<script setup>
import { ref } from 'vue';
import { useAuthStore } from '@/stores/auth';

const auth = useAuthStore();
const form = ref({ email: '', password: '' });

const handleLogin = async () => {
  await auth.login(form.value);
  // Redirect after login
  router.push('/dashboard');
};
</script>

<template>
  <form @submit.prevent="handleLogin">
    <input v-model="form.email" type="email">
    <input v-model="form.password" type="password">
    <button type="submit">Login</button>
  </form>
</template>
```

---

## **5. Access State in Other Components**
### **Navbar Component (`resources/js/components/Navbar.vue`)**
```vue
<script setup>
import { useAuthStore } from '@/stores/auth';
const auth = useAuthStore();
</script>

<template>
  <div>
    <span v-if="auth.isAuthenticated">
      Welcome, {{ auth.user.name }}!
    </span>
    <button v-if="auth.isAuthenticated" @click="auth.logout">
      Logout
    </button>
  </div>
</template>
```

---

## **6. Hydrate Store with Laravel Data**
### **Pass Initial State from Blade**
```php
<main-app :initial-auth="{{ json_encode([
    'user' => auth()->user(),
    'token' => session('token'),
]) }}"></main-app>
```

### **Hydrate Pinia Store on Load**
```js
// In your main App.vue
import { useAuthStore } from '@/stores/auth';

const props = defineProps(['initialAuth']);
const auth = useAuthStore();

if (props.initialAuth) {
  auth.$patch({
    user: props.initialAuth.user,
    token: props.initialAuth.token,
  });
}
```

---

## **Key Benefits for Laravel Apps**
1. **Shared State**  
   - Access user/auth state across all components  
2. **API Caching**  
   - Store API responses to avoid duplicate requests  
3. **Persistent State**  
   - Sync with localStorage for page refreshes  
4. **Type Safety**  
   - Works perfectly with TypeScript  

---

## **Pinia vs. Vuex**
| Feature         | Pinia | Vuex |
|----------------|-------|------|
| Syntax         | Simpler | More boilerplate |
| TypeScript     | Excellent | Good |
| Modules        | Automatic | Manual |
| DevTools       | Built-in | Plugin |
| Size           | 1KB | 4KB |

---

## **Advanced Pattern: API Service Integration**
```js
// resources/js/stores/posts.js
export const usePostStore = defineStore('posts', {
  state: () => ({
    posts: [],
  }),

  actions: {
    async fetchPosts() {
      this.posts = await axios.get('/api/posts');
    },
  },
});
```

---

### **When to Use Pinia in Laravel**
1. **User authentication state**  
2. **Shared UI state (modals, themes)**  
3. **Caching API responses**  
4. **Complex multi-component state**  

For simple props, just use component state. For everything else: **Pinia**.

---