### **Vue Composables in Laravel: Reusable Logic with Composition API**

Composables are **Vue 3's** way of creating reusable, stateful logic (similar to React hooks). They're perfect for sharing functionality across components in Laravel+Vue apps.

---

## **1. What Are Composables?**
- **Functions** that use Vue's Composition API (`ref`, `computed`, `onMounted`, etc.)
- **Encapsulate logic** (API calls, form handling, WebSocket connections)
- **Reusable across components** without mixins or global state

---

## **2. Basic Example: useFetch Composable**
Create `resources/js/composables/useFetch.js`:
```javascript
import { ref } from 'vue';
import axios from '@/axios'; // Your configured Axios instance

export function useFetch(url) {
  const data = ref(null);
  const loading = ref(false);
  const error = ref(null);

  const fetchData = async () => {
    loading.value = true;
    try {
      const response = await axios.get(url);
      data.value = response.data;
    } catch (err) {
      error.value = err.response?.data?.message || err.message;
    } finally {
      loading.value = false;
    }
  };

  return { data, loading, error, fetchData };
}
```

**Usage in Component:**
```vue
<script setup>
import { useFetch } from '@/composables/useFetch';

const { data: posts, loading, error } = useFetch('/api/posts');
</script>

<template>
  <div v-if="loading">Loading...</div>
  <div v-else-if="error">{{ error }}</div>
  <ul v-else>
    <li v-for="post in posts" :key="post.id">{{ post.title }}</li>
  </ul>
</template>
```

---

## **3. Laravel-Specific Composables**
### **3.1. useAuth (Authentication Logic)**
`resources/js/composables/useAuth.js`:
```javascript
import { ref } from 'vue';
import axios from '@/axios';
import { useRouter } from 'vue-router';

export function useAuth() {
  const user = ref(null);
  const router = useRouter();

  const login = async (credentials) => {
    try {
      const { data } = await axios.post('/api/login', credentials);
      user.value = data.user;
      localStorage.setItem('token', data.token);
      router.push('/dashboard');
    } catch (error) {
      throw error.response?.data?.errors;
    }
  };

  const logout = () => {
    user.value = null;
    localStorage.removeItem('token');
    router.push('/login');
  };

  return { user, login, logout };
}
```

**Usage:**
```vue
<script setup>
import { useAuth } from '@/composables/useAuth';
const { user, login, logout } = useAuth();
</script>
```

---

### **3.2. useForm (Form Handling with Laravel Validation)**
`resources/js/composables/useForm.js`:
```javascript
import { ref } from 'vue';
import axios from '@/axios';

export function useForm(initialData) {
  const form = ref({ ...initialData });
  const errors = ref({});
  const processing = ref(false);

  const submit = async (url, method = 'post') => {
    processing.value = true;
    errors.value = {};

    try {
      await axios[method](url, form.value);
    } catch (error) {
      if (error.response?.status === 422) {
        errors.value = error.response.data.errors;
      }
      throw error;
    } finally {
      processing.value = false;
    }
  };

  return { form, errors, processing, submit };
}
```

**Usage:**
```vue
<script setup>
import { useForm } from '@/composables/useForm';

const { form, errors, processing, submit } = useForm({
  email: '',
  password: ''
});

const handleLogin = () => submit('/api/login');
</script>
```

---

## **4. Advanced: useWebSocket (Laravel Echo Integration)**
`resources/js/composables/useWebSocket.js`:
```javascript
import { ref, onUnmounted } from 'vue';
import echo from '@/echo';

export function useWebSocket(channelName, eventHandlers) {
  const channel = echo.channel(channelName);

  Object.entries(eventHandlers).forEach(([event, handler]) => {
    channel.listen(event, handler);
  });

  onUnmounted(() => {
    echo.leave(channelName);
  });

  return { channel };
}
```

**Usage:**
```vue
<script setup>
import { useWebSocket } from '@/composables/useWebSocket';

const { channel } = useWebSocket('orders.1', {
  'OrderUpdated': (data) => console.log('Order updated:', data)
});
</script>
```

---

## **5. Best Practices for Laravel+Vue Composables**
1. **Prefix with `use`** (`useAuth`, `useFetch`)  
2. **Keep Laravel API calls centralized** in composables  
3. **Handle Laravel validation errors** consistently  
4. **TypeScript support** (add `.d.ts` files for type safety)  
5. **Composable dependencies** can include:
   - Axios (for API calls)  
   - Pinia (for global state)  
   - Vue Router (for navigation)  

---

## **When to Use Composables?**
| Scenario | Solution |
|----------|----------|
| **API calls** | `useFetch`, `useApi` |
| **Forms** | `useForm` |
| **Authentication** | `useAuth` |
| **WebSockets** | `useWebSocket` |
| **UI Logic** | `useModal`, `useDarkMode` |

---

### **Example: usePagination (Laravel API Pagination)**
```javascript
export function usePagination(initialPage = 1) {
  const currentPage = ref(initialPage);
  const lastPage = ref(1);

  const nextPage = () => currentPage.value++;
  const prevPage = () => currentPage.value--;

  return { currentPage, lastPage, nextPage, prevPage };
}

// Usage with Laravel's paginated responses:
// const { data } = await axios.get(`/api/posts?page=${currentPage.value}`);
```

---

## **Key Benefits for Laravel Developers**
1. **Reusable API logic** across components  
2. **Clean separation** between UI and business logic  
3. **Easy testing** (mock composables in Jest/Vitest)  
4. **TypeScript-ready** for better maintainability  
