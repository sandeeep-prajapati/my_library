
---

## 🎯 Goal:

* Setup **PHPUnit** for your package using Laravel's `Testbench`.
* Write **unit/integration tests** for your package.
* Set up **GitHub Actions** to run tests on each push/pull request.

---

## 🛠️ Step-by-Step Guide

---

### 🧰 1. Install Laravel Testbench

Testbench is the official way to test Laravel packages **outside of a full Laravel app**.

Add it to your `require-dev` in `composer.json`:

```bash
cd packages/sandeep/mytools

composer require --dev orchestra/testbench "^8.0"
```

> Use the version that matches your Laravel version (e.g., Laravel 10 → Testbench 8.x)

---

### 🧪 2. Create a Basic Test Case

Create the test directory and file:

```bash
mkdir -p tests
touch tests/MyToolsTest.php
```

---

#### ✏️ `tests/MyToolsTest.php`

```php
<?php

namespace Sandeep\MyTools\Tests;

use Orchestra\Testbench\TestCase;
use Sandeep\MyTools\MyToolsServiceProvider;
use Illuminate\Support\Facades\Config;

class MyToolsTest extends TestCase
{
    protected function getPackageProviders($app)
    {
        return [MyToolsServiceProvider::class];
    }

    public function test_it_returns_custom_greeting()
    {
        Config::set('mytools.greeting_prefix', 'Hola');
        $this->assertEquals('Hola, Sandeep! This is from your Laravel package.', mytools_greet('Sandeep'));
    }
}
```

---

### ⚙️ 3. Add `phpunit.xml` Configuration

Create a file in your package root:

```xml
<!-- phpunit.xml -->
<?xml version="1.0" encoding="UTF-8"?>
<phpunit bootstrap="vendor/autoload.php"
         colors="true"
         convertErrorsToExceptions="true"
         convertWarningsToExceptions="true"
         convertNoticesToExceptions="true">
    <testsuites>
        <testsuite name="MyTools Test Suite">
            <directory suffix="Test.php">./tests</directory>
        </testsuite>
    </testsuites>
</phpunit>
```

---

### ▶️ 4. Run the Tests

In the root of your package:

```bash
./vendor/bin/phpunit
```

✅ Output:

```
OK (1 test, 1 assertion)
```

---

### 🔄 5. Add GitHub Actions for Continuous Integration

Create `.github/workflows/tests.yml` in your **GitHub repo** root (not inside the package):

```yaml
name: Run Laravel Package Tests

on: [push, pull_request]

jobs:
  test:
    runs-on: ubuntu-latest
    name: PHP Test Suite

    steps:
      - uses: actions/checkout@v3

      - name: Set up PHP
        uses: shivammathur/setup-php@v2
        with:
          php-version: '8.2'

      - name: Install dependencies
        run: |
          cd packages/sandeep/mytools
          composer install --no-progress --no-suggest --prefer-dist

      - name: Run PHPUnit tests
        run: |
          cd packages/sandeep/mytools
          ./vendor/bin/phpunit
```

---

### ✅ 6. Commit & Push

```bash
git add .
git commit -m "✅ Add PHPUnit tests & GitHub Actions CI"
git push origin main
```

GitHub will now automatically run your tests on every push or pull request!

---

## ✅ Summary

| ✅ Step           | Description                             |
| ---------------- | --------------------------------------- |
| `Testbench`      | Lightweight Laravel for package testing |
| `tests/*.php`    | Write unit/integration tests            |
| `phpunit.xml`    | Config for running tests                |
| `GitHub Actions` | Automatically run tests on push/PR      |

---

### 🧠 Bonus Tips

* Add a `Tool` model test (`test_it_creates_tool`)
* Test Blade views using Laravel's `see()` / `assertViewHas()`
* Use `artisan` in Testbench: `$this->artisan('mytools:greet Sandeep')`

---

