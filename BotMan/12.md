
---

## ‚úÖ Step-by-Step Implementation

### **1. Install PDF Generator (e.g., DomPDF via Barryvdh Package)**

```bash
composer require barryvdh/laravel-dompdf
```

Then add the service provider in `config/app.php` if not auto-discovered:

```php
Barryvdh\DomPDF\ServiceProvider::class,
```

And the alias:

```php
'PDF' => Barryvdh\DomPDF\Facade::class,
```

---

### **2. Create PDF Blade View**

Create a view at: `resources/views/pdf/order_bill.blade.php`

```blade
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Order Bill</title>
    <style>
        body { font-family: sans-serif; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { padding: 10px; border: 1px solid #ccc; text-align: left; }
        h2 { text-align: center; }
    </style>
</head>
<body>
    <h2>Order Invoice</h2>
    <p><strong>Customer:</strong> {{ $customer }}</p>
    <table>
        <thead>
            <tr><th>Item</th><th>Qty</th><th>Price</th><th>Total</th></tr>
        </thead>
        <tbody>
            @foreach ($items as $item)
                <tr>
                    <td>{{ $item['dish'] }}</td>
                    <td>{{ $item['quantity'] }}</td>
                    <td>‚Çπ{{ $item['price'] }}</td>
                    <td>‚Çπ{{ $item['total'] }}</td>
                </tr>
            @endforeach
        </tbody>
    </table>
    <p><strong>Subtotal:</strong> ‚Çπ{{ $subtotal }}</p>
    <p><strong>Tax (5%):</strong> ‚Çπ{{ $tax }}</p>
    <p><strong>Total:</strong> ‚Çπ{{ $total }}</p>
</body>
</html>
```

---

### **3. Generate the PDF in Controller or Conversation Class**

```php
use PDF;
use Illuminate\Support\Facades\Storage;

public function generatePdfAndSendLink($bot, $orderData)
{
    $pdf = PDF::loadView('pdf.order_bill', [
        'customer' => $orderData['customer'],
        'items' => $orderData['items'],
        'subtotal' => $orderData['subtotal'],
        'tax' => $orderData['tax'],
        'total' => $orderData['total'],
    ]);

    $filename = 'order_' . uniqid() . '.pdf';
    $pdfPath = storage_path("app/public/orders/{$filename}");
    $pdf->save($pdfPath);

    // Optional: Store in public disk to share via link
    Storage::disk('public')->put("orders/{$filename}", $pdf->output());

    $url = url("storage/orders/{$filename}");

    $bot->reply("üßæ Your order bill is ready! [Click here to download]({$url})");
}
```

---

### **4. Ensure Files Are Publicly Accessible**

Run this if not already done:

```bash
php artisan storage:link
```

This creates a symbolic link from `public/storage` to `storage/app/public`.

---

### ‚úÖ Bonus: Sample Call in Botman Conversation

```php
$this->generatePdfAndSendLink($this->bot, $orderSummaryData);
```

---

### ‚ö†Ô∏è Security Note

For production:

* Consider adding auth or unique tokens to protect file links.
* Periodically delete old PDFs.

---
