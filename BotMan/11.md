
---

### âœ… **1. Calculate Order Summary (Backend - Laravel Controller or Conversation Class)**

Assume youâ€™ve already collected dish name(s), quantity, and any special notes from the user.

```php
public function showOrderSummary($orderItems)
{
    $subtotal = 0;
    foreach ($orderItems as &$item) {
        $dish = Dish::where('name', $item['dish'])->first(); // Fetch price
        $item['price'] = $dish->price;
        $item['total'] = $dish->price * $item['quantity'];
        $subtotal += $item['total'];
    }

    $tax = $subtotal * 0.05; // 5% tax
    $total = $subtotal + $tax;

    return [
        'items' => $orderItems,
        'subtotal' => $subtotal,
        'tax' => $tax,
        'total' => $total,
    ];
}
```

---

### âœ… **2. Display Order Summary using Botman Message**

Use Botmanâ€™s `Question` and `Button` class to show the summary and confirm/cancel options.

```php
use BotMan\BotMan\Messages\Outgoing\Question;
use BotMan\BotMan\Messages\Outgoing\Actions\Button;

public function askForConfirmation($bot, $summary)
{
    $summaryText = "ðŸ§¾ *Order Summary:*\n";
    foreach ($summary['items'] as $item) {
        $summaryText .= "- {$item['dish']} x{$item['quantity']} = â‚¹{$item['total']}\n";
    }
    $summaryText .= "\nSubtotal: â‚¹{$summary['subtotal']}";
    $summaryText .= "\nTax (5%): â‚¹{$summary['tax']}";
    $summaryText .= "\n*Total: â‚¹{$summary['total']}*";

    $question = Question::create($summaryText)
        ->addButtons([
            Button::create('âœ… Confirm Order')->value('confirm_order'),
            Button::create('âŒ Cancel')->value('cancel_order'),
        ]);

    $bot->reply($question);
}
```

---

### âœ… **3. Handle User Selection**

```php
$botman->hears('confirm_order|cancel_order', function (BotMan $bot) {
    $message = $bot->getMessage()->getText();
    
    if ($message === 'confirm_order') {
        // Save order to DB
        $bot->reply('ðŸŽ‰ Your order has been confirmed! Thank you.');
    } else {
        $bot->reply('âŒ Order has been canceled. Let us know if you change your mind!');
    }
});
```

---

### âœ… Tips

* Use markdown for styling (`*bold*`, `\n` for line breaks).
* Store conversation data using `$this->remember()` and `$this->get()` in a `Conversation` class.
* Auto-send confirmation SMS/email or trigger order printing on confirmation.

