
---

### âœ… 1. **Set up your `Order` model**

```bash
php artisan make:model Order
```

Edit the model to allow mass assignment:

```php
// app/Models/Order.php
namespace App\Models;

use Illuminate\Database\Eloquent\Model;

class Order extends Model
{
    protected $fillable = [
        'customer_name', 'items', 'special_notes', 'status'
    ];

    protected $casts = [
        'items' => 'array',
    ];
}
```

---

### âœ… 2. **Create your orders table migration**

If not already done:

```bash
php artisan make:migration create_orders_table
```

```php
// database/migrations/xxxx_xx_xx_create_orders_table.php

use Illuminate\Database\Migrations\Migration;
use Illuminate\Database\Schema\Blueprint;
use Illuminate\Support\Facades\Schema;

class CreateOrdersTable extends Migration
{
    public function up(): void
    {
        Schema::create('orders', function (Blueprint $table) {
            $table->id();
            $table->string('customer_name');
            $table->json('items');
            $table->text('special_notes')->nullable();
            $table->enum('status', ['pending', 'preparing', 'delivered'])->default('pending');
            $table->timestamps();
        });
    }

    public function down(): void
    {
        Schema::dropIfExists('orders');
    }
}
```

Run the migration:

```bash
php artisan migrate
```

---

### âœ… 3. **Define the Botman Conversation**

```php
// app/Botman/Conversations/OrderConversation.php

namespace App\Botman\Conversations;

use BotMan\BotMan\Messages\Conversations\Conversation;
use App\Models\Order;

class OrderConversation extends Conversation
{
    protected $order = [];

    public function askName()
    {
        $this->ask('What is your name?', function ($answer) {
            $this->order['customer_name'] = $answer;
            $this->askDish();
        });
    }

    public function askDish()
    {
        $this->ask('What dish would you like to order?', function ($answer) {
            $this->order['items'][] = ['dish' => $answer, 'quantity' => 1]; // Simplified
            $this->askNotes();
        });
    }

    public function askNotes()
    {
        $this->ask('Any special requests?', function ($answer) {
            $this->order['special_notes'] = $answer;

            // âœ… Save to database
            Order::create($this->order);

            $this->say('Thank you! Your order has been placed.');
        });
    }

    public function run()
    {
        $this->askName();
    }
}
```

---

### âœ… 4. **Trigger the Conversation**

In your `web.php` or Botman route file:

```php
use App\Botman\Conversations\OrderConversation;

$botman->hears('order', function($bot) {
    $bot->startConversation(new OrderConversation);
});
```

---

### ðŸ§ª Test:

Type `order` in your chatbot to trigger the full conversation. After you provide the name, dish, and notes, an order will be stored in the `orders` table.

---

Let me know if you'd like to:

* Add multiple items in a single order
* Add buttons for dish selection
* Send a confirmation message to admin
