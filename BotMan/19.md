To create an **Order History Report** for admins using **Laravel** and **Laravel Charts**, follow this plan with milestones and code structure:

---

## 📊 Feature: Admin Order History Dashboard (Analytics)

### ✅ **Key Metrics to Show**

1. 📈 **Most Ordered Items**
2. 🕑 **Peak Order Times** (by hour/day)
3. 💰 **Average Order Value**

---

## 🔧 Step-by-Step Implementation

---

### 1. **Install Laravel Charts**

Use [ConsoleTVs/Charts](https://github.com/ConsoleTVs/Charts)

```bash
composer require consoletvs/charts
```

---

### 2. **Create Controller**

```bash
php artisan make:controller Admin/ReportController
```

---

### 3. **Add Routes**

```php
// routes/web.php
Route::middleware(['auth', 'admin'])->prefix('admin')->group(function () {
    Route::get('/reports', [ReportController::class, 'index'])->name('admin.reports');
});
```

---

### 4. **Prepare Data in Controller**

```php
use App\Models\Order;
use App\Models\OrderItem;
use Carbon\Carbon;
use ConsoleTVs\Charts\Facades\Charts;

public function index()
{
    // Most Ordered Items
    $topItems = OrderItem::selectRaw('item_name, COUNT(*) as count')
                ->groupBy('item_name')
                ->orderByDesc('count')
                ->take(5)
                ->pluck('count', 'item_name');

    // Peak Order Times (by hour)
    $peakHours = Order::selectRaw('HOUR(created_at) as hour, COUNT(*) as count')
                ->groupBy('hour')
                ->orderBy('hour')
                ->pluck('count', 'hour');

    // Average Order Value
    $avgOrderValue = Order::avg('total');

    return view('admin.reports.index', compact('topItems', 'peakHours', 'avgOrderValue'));
}
```

---

### 5. **Create Blade View with Charts**

```blade
@extends('layouts.admin')

@section('content')
<h2 class="text-xl font-bold">📊 Order Analytics</h2>

{{-- Top Items --}}
<div>
    <h3>🍔 Most Ordered Items</h3>
    <ul>
        @foreach ($topItems as $item => $count)
            <li>{{ $item }} - {{ $count }} orders</li>
        @endforeach
    </ul>
</div>

{{-- Peak Hours --}}
<div>
    <h3>⏰ Peak Order Times</h3>
    <canvas id="hourChart"></canvas>
</div>

{{-- Average Order Value --}}
<div>
    <h3>💰 Average Order Value</h3>
    <p>₹{{ number_format($avgOrderValue, 2) }}</p>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    const ctx = document.getElementById('hourChart').getContext('2d');
    const hourChart = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: {!! json_encode($peakHours->keys()) !!},
            datasets: [{
                label: 'Orders per Hour',
                data: {!! json_encode($peakHours->values()) !!},
                backgroundColor: '#4e73df',
            }]
        }
    });
</script>
@endsection
```

---

## 📌 Optional Enhancements

| Feature           | Description                                       |
| ----------------- | ------------------------------------------------- |
| 📅 Filter by Date | Use a date range picker for filtering stats       |
| 📥 Export to CSV  | Add Laravel Excel to export reports               |
| 🔁 Live Update    | Auto-refresh dashboard every 5 mins               |
| 📈 Line Chart     | Use line chart to visualize weekly/monthly trends |

---

## ✅ Milestone Summary

1. ✅ Setup Laravel Charts
2. ✅ Create ReportController
3. ✅ Route `/admin/reports`
4. ✅ Query most ordered items
5. ✅ Calculate peak order hours
6. ✅ Compute average order value
7. ✅ Blade view with Chart.js
8. ✅ Styling and icons
9. ✅ Optional: Filters and CSV Export

---
