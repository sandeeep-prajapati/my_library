
---

### âœ… Step 1: Create the `menus` and `dishes` tables

Use Laravel migrations:

```bash
php artisan make:model Menu -m
php artisan make:model Dish -m
```

In the `create_menus_table.php`:

```php
Schema::create('menus', function (Blueprint $table) {
    $table->id();
    $table->string('category_name');
    $table->timestamps();
});
```

In the `create_dishes_table.php`:

```php
Schema::create('dishes', function (Blueprint $table) {
    $table->id();
    $table->foreignId('menu_id')->constrained();
    $table->string('name');
    $table->decimal('price', 8, 2);
    $table->boolean('available')->default(true);
    $table->timestamps();
});
```

Run:

```bash
php artisan migrate
```

---

### âœ… Step 2: Define Eloquent Relationships

In `Menu.php`:

```php
public function dishes() {
    return $this->hasMany(Dish::class);
}
```

In `Dish.php`:

```php
public function menu() {
    return $this->belongsTo(Menu::class);
}
```

---

### âœ… Step 3: Seed Sample Data

Use seeders or `tinker` to populate data:

```php
$menu = Menu::create(['category_name' => 'Pizza']);
$menu->dishes()->createMany([
    ['name' => 'Margherita', 'price' => 299],
    ['name' => 'Pepperoni', 'price' => 349],
]);
```

---

### âœ… Step 4: Use Botman to Fetch and Display Dynamic Menu

In your `BotManController.php` or conversation handler:

```php
use App\Models\Menu;
use BotMan\BotMan\Messages\Conversations\Conversation;
use BotMan\BotMan\Messages\Outgoing\Question;
use BotMan\BotMan\Messages\Outgoing\Actions\Button;

public function askMenu() {
    $menus = Menu::with('dishes')->get();

    foreach ($menus as $menu) {
        $buttons = [];

        foreach ($menu->dishes->where('available', true) as $dish) {
            $buttons[] = Button::create($dish->name . ' â‚¹' . $dish->price)->value($dish->id);
        }

        $question = Question::create("ðŸ“‹ *" . $menu->category_name . "* Menu:")
                    ->addButtons($buttons);

        $this->bot->reply($question);
    }
}
```

---

### âœ… Step 5: Trigger this with a command like 'menu'

In `routes/botman.php`:

```php
$botman->hears('menu', function($bot) {
    $bot->startConversation(new \App\Conversations\ShowMenuConversation());
});
```

---
