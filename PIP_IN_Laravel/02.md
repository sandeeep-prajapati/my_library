Hereâ€™s how you can create the Laravel Artisan command `php artisan py:install` to:

* **Activate the `.venv`** (Python virtual environment)
* **Install packages from `requirements.txt`** using `pip`

---

## âœ… Step-by-Step: `py:install` Command

### 1. Generate Artisan Command

```bash
php artisan make:command PyInstallCommand
```

This will create:
`app/Console/Commands/PyInstallCommand.php`

---

### 2. Edit the Command File

Replace the contents with:

```php
<?php

namespace App\Console\Commands;

use Illuminate\Console\Command;
use Symfony\Component\Process\Process;

class PyInstallCommand extends Command
{
    protected $signature = 'py:install';
    protected $description = 'Activate the Python virtual environment and install dependencies from requirements.txt';

    public function handle()
    {
        $venvPath = base_path('.venv');
        $requirementsPath = base_path('requirements.txt');

        // Step 1: Check virtual environment
        if (!is_dir($venvPath)) {
            $this->error('.venv not found. Run `php artisan py:init` first.');
            return 1;
        }

        // Step 2: Check requirements.txt
        if (!file_exists($requirementsPath)) {
            $this->error('requirements.txt not found.');
            return 1;
        }

        // Step 3: Install dependencies using pip from virtual environment
        $this->info('Installing dependencies from requirements.txt...');

        $pipPath = $venvPath . '/bin/pip';

        // Windows compatibility
        if (strtoupper(substr(PHP_OS, 0, 3)) === 'WIN') {
            $pipPath = $venvPath . '\\Scripts\\pip.exe';
        }

        if (!file_exists($pipPath)) {
            $this->error("Could not find pip in .venv. Make sure it's correctly created.");
            return 1;
        }

        $process = new Process([$pipPath, 'install', '-r', $requirementsPath]);
        $process->run();

        if (!$process->isSuccessful()) {
            $this->error('Failed to install packages:');
            $this->error($process->getErrorOutput());
            return 1;
        }

        $this->info('Dependencies installed successfully.');
        $this->line($process->getOutput());

        return 0;
    }
}
```

---

### 3. Test the Command

```bash
php artisan py:install
```

Expected behavior:

* Looks for `.venv` and `requirements.txt`
* Runs: `.venv/bin/pip install -r requirements.txt` (or `.venv\Scripts\pip.exe` on Windows)
* Outputs install success or failure messages

---

## ðŸ§ª Example

Your `requirements.txt`:

```
numpy==1.26.4
pandas
scikit-learn
```

After running:

```bash
php artisan py:install
```

Output:

```
Installing dependencies from requirements.txt...
Dependencies installed successfully.
...
```

---

## âœ… Bonus Ideas (Future Features)

* Add `--package=numpy` option to install a package directly and append it to `requirements.txt`
* Add logging to `storage/logs/python.log`
* Validate the syntax of `requirements.txt` before install
* Show progress bar (via Symfony process output streaming)

---
