Here's how to create a **REST endpoint in Laravel** to return the list of currently installed Python packages from the `.venv` using `pip list --format=json`.

---

## âœ… Step-by-Step: `GET /api/python/installed`

---

### 1. ðŸ›  Update the Controller

Use the same `PythonPackageController` and add a new method:

```php
public function listInstalledPackages()
{
    $venvPath = base_path('.venv');

    // Determine pip path
    $pipPath = $venvPath . '/bin/pip';
    if (strtoupper(substr(PHP_OS, 0, 3)) === 'WIN') {
        $pipPath = $venvPath . '\\Scripts\\pip.exe';
    }

    if (!file_exists($pipPath)) {
        return response()->json([
            'success' => false,
            'message' => 'Python virtual environment not found. Run `php artisan py:init` first.',
        ], 500);
    }

    // Run `pip list` with JSON output
    $process = new \Symfony\Component\Process\Process([$pipPath, 'list', '--format=json']);
    $process->run();

    if (!$process->isSuccessful()) {
        return response()->json([
            'success' => false,
            'message' => 'Failed to fetch packages.',
            'error' => $process->getErrorOutput(),
        ], 500);
    }

    $output = json_decode($process->getOutput(), true);
    $packages = collect($output)->pluck('name')->values();

    return response()->json([
        'success' => true,
        'installed' => $packages,
    ]);
}
```

---

### 2. ðŸ”— Add Route

Add this to your `routes/api.php` file:

```php
use App\Http\Controllers\PythonPackageController;

Route::get('/python/installed', [PythonPackageController::class, 'listInstalledPackages']);
```

---

### 3. ðŸ§ª Test the Endpoint

**Request:**

```
GET /api/python/installed
```

**Expected JSON Response:**

```json
{
  "success": true,
  "installed": [
    "flask",
    "requests",
    "pandas",
    "scikit-learn"
  ]
}
```

---

### ðŸ§  Notes

* Uses `pip list --format=json` for clean parsing
* Works cross-platform (Windows/Linux/macOS)
* Fast and API-friendly

---

Let me know if you'd like:

* A versioned response (e.g., `"pandas": "2.0.1"`)
* An uninstall endpoint
* A Blade dashboard to manage these interactively
