Here's how to use Laravel's HTTP client to query a **Qdrant vector database** from your backend, including proper error handling and response processing:

---

### **1. Laravel Route & Controller**

#### **Route (`routes/api.php`)**
```php
use App\Http\Controllers\SearchController;

Route::post('/search-similar', [SearchController::class, 'findSimilar']);
```

#### **Controller (`app/Http/Controllers/SearchController.php`)**
```php
<?php

namespace App\Http\Controllers;

use Illuminate\Http\Request;
use Illuminate\Support\Facades\Http;
use Illuminate\Support\Facades\Log;

class SearchController extends Controller
{
    public function findSimilar(Request $request)
    {
        $request->validate([
            'vector' => 'required|array',
            'vector.*' => 'numeric',
            'limit' => 'sometimes|integer|min:1|max:100'
        ]);

        try {
            $response = Http::timeout(30)->post('http://qdrant:6333/collections/images/points/search', [
                'vector' => $request->vector,
                'limit' => $request->input('limit', 5),
                'with_payload' => true,
                'with_vectors' => false
            ]);

            if ($response->successful()) {
                return $response->json();
            }

            Log::error('Qdrant search failed', [
                'status' => $response->status(),
                'error' => $response->body()
            ]);
            return response()->json(['error' => 'Vector search failed'], 500);

        } catch (\Exception $e) {
            Log::error('Qdrant connection error: ' . $e->getMessage());
            return response()->json(['error' => 'Service unavailable'], 503);
        }
    }
}
```

---

### **2. Qdrant Search Request Details**

#### **Payload Structure**
```php
[
    'vector' => [0.12, 0.34, ..., 0.98], // Your embedding vector
    'limit' => 5,                         // Top N results
    'filter' => [                         // Optional filters
        'must' => [
            ['key' => 'category', 'match' => ['value' => 'animal']]
        ]
    ],
    'params' => [                         // Search tuning
        'hnsw_ef' => 128                  // Balance speed/accuracy
    ]
]
```

#### **Example cURL Test**
```bash
curl -X POST http://your-laravel-app/api/search-similar \
  -H "Content-Type: application/json" \
  -d '{"vector": [0.1, 0.2, ...], "limit": 3}'
```

---

### **3. Advanced Features**

#### **Filtering Results**
Add metadata filters to narrow results:
```php
$response = Http::post('http://qdrant:6333/collections/images/points/search', [
    'vector' => $request->vector,
    'filter' => [
        'must' => [
            ['key' => 'user_id', 'match' => ['value' => auth()->id()]]
        ]
    ]
]);
```

#### **Hybrid Search (Vector + Keywords)**
```php
$response = Http::post('http://qdrant:6333/collections/images/points/search', [
    'vector' => $request->vector,
    'filter' => [
        'should' => [
            ['key' => 'description', 'match' => ['text' => $request->search_term]]
        ]
    ]
]);
```

---

### **4. Error Handling Best Practices**

1. **Timeout Configuration**:
   ```php
   Http::timeout(15)->connectTimeout(5)->post(...)
   ```

2. **Retry Mechanism**:
   ```php
   Http::retry(3, 100)->post(...)
   ```

3. **Circuit Breaker**:
   Use Laravel's `Cache` to temporarily disable Qdrant queries after repeated failures.

---

### **5. Performance Optimization**

1. **Batch Searching**:
   ```php
   Http::post('http://qdrant:6333/collections/images/points/search/batch', [
       'searches' => [
           ['vector' => $vector1, 'limit' => 5],
           ['vector' => $vector2, 'limit' => 3]
       ]
   ]);
   ```

2. **Caching Results**:
   ```php
   $cacheKey = 'vector_search:' . md5(implode(',', $request->vector));
   return Cache::remember($cacheKey, now()->addHours(1), function() use ($request) {
       return Http::post(...)->json();
   });
   ```

---

### **6. Docker Network Setup**

Ensure Laravel can access Qdrant in your `docker-compose.yml`:
```yaml
services:
  laravel:
    networks:
      - qdrant_network

  qdrant:
    image: qdrant/qdrant
    networks:
      - qdrant_network
    ports:
      - "6333:6333"

networks:
  qdrant_network:
    driver: bridge
```

---

### **Response Format**
Successful responses will mirror Qdrant's API:
```json
{
  "result": [
    {
      "id": 123,
      "score": 0.92,
      "payload": {"image_id": "img1.jpg", "category": "animal"}
    }
  ],
  "status": "ok",
  "time": 0.005
}
```

---

This implementation gives you a **production-ready** vector search endpoint with:
- Input validation
- Comprehensive error handling
- Metadata filtering
- Performance optimizations
- Docker compatibility

For large-scale deployments, consider adding:
- Request rate limiting
- API authentication
- Query logging